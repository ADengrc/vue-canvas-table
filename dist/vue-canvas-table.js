!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.VueCanvasTable=e():t.VueCanvasTable=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/dist/",e(e.s=1)}([function(t,e,i){"use strict";var n=i(9),o=i(11),r=i(12),s=i(13);e.a={mixins:[n.a,o.a,r.a,s.a],mounted:function(){this.init()},watch:{"config.source":function(t,e){t!==e&&this.init()}}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i(2);e.default=n.a},function(t,e,i){"use strict";function n(t){i(3)}var o=i(0),r=i(14),s=i(8),a=n,h=s(o.a,r.a,!1,a,"data-v-34b3b350",null);e.a=h.exports},function(t,e,i){var n=i(4);"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);i(6)("e515062a",n,!0,{})},function(t,e,i){e=t.exports=i(5)(!1),e.push([t.i,".container[data-v-34b3b350]{position:relative}.H[data-v-34b3b350],.V[data-v-34b3b350]{position:absolute;opacity:0;transition:opacity .3s ease-in-out}.V[data-v-34b3b350]{right:1px;top:1px;bottom:1px}.H[data-v-34b3b350]{bottom:1px;left:1px;right:1px}.slider[data-v-34b3b350]{position:relative;height:10px;width:10px;border-radius:5px}",""])},function(t,e){function i(t,e){var i=t[1]||"",o=t[3];if(!o)return i;if(e&&"function"==typeof btoa){var r=n(o);return[i].concat(o.sources.map(function(t){return"/*# sourceURL="+o.sourceRoot+t+" */"})).concat([r]).join("\n")}return[i].join("\n")}function n(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=i(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var r=this[o][0];"number"==typeof r&&(n[r]=!0)}for(o=0;o<t.length;o++){var s=t[o];"number"==typeof s[0]&&n[s[0]]||(i&&!s[2]?s[2]=i:i&&(s[2]="("+s[2]+") and ("+i+")"),e.push(s))}},e}},function(t,e,i){function n(t){for(var e=0;e<t.length;e++){var i=t[e],n=c[i.id];if(n){n.refs++;for(var o=0;o<n.parts.length;o++)n.parts[o](i.parts[o]);for(;o<i.parts.length;o++)n.parts.push(r(i.parts[o]));n.parts.length>i.parts.length&&(n.parts.length=i.parts.length)}else{for(var s=[],o=0;o<i.parts.length;o++)s.push(r(i.parts[o]));c[i.id]={id:i.id,refs:1,parts:s}}}}function o(){var t=document.createElement("style");return t.type="text/css",u.appendChild(t),t}function r(t){var e,i,n=document.querySelector("style["+m+'~="'+t.id+'"]');if(n){if(p)return v;n.parentNode.removeChild(n)}if(y){var r=d++;n=f||(f=o()),e=s.bind(null,n,r,!1),i=s.bind(null,n,r,!0)}else n=o(),e=a.bind(null,n),i=function(){n.parentNode.removeChild(n)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else i()}}function s(t,e,i,n){var o=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=x(e,o);else{var r=document.createTextNode(o),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(r,s[e]):t.appendChild(r)}}function a(t,e){var i=e.css,n=e.media,o=e.sourceMap;if(n&&t.setAttribute("media",n),g.ssrId&&t.setAttribute(m,e.id),o&&(i+="\n/*# sourceURL="+o.sources[0]+" */",i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}var h="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!h)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var l=i(7),c={},u=h&&(document.head||document.getElementsByTagName("head")[0]),f=null,d=0,p=!1,v=function(){},g=null,m="data-vue-ssr-id",y="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());t.exports=function(t,e,i,o){p=i,g=o||{};var r=l(t,e);return n(r),function(e){for(var i=[],o=0;o<r.length;o++){var s=r[o],a=c[s.id];a.refs--,i.push(a)}e?(r=l(t,e),n(r)):r=[];for(var o=0;o<i.length;o++){var a=i[o];if(0===a.refs){for(var h=0;h<a.parts.length;h++)a.parts[h]();delete c[a.id]}}}};var x=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t,e){for(var i=[],n={},o=0;o<e.length;o++){var r=e[o],s=r[0],a=r[1],h=r[2],l=r[3],c={id:t+":"+o,css:a,media:h,sourceMap:l};n[s]?n[s].parts.push(c):i.push(n[s]={id:s,parts:[c]})}return i}},function(t,e){t.exports=function(t,e,i,n,o,r){var s,a=t=t||{},h=typeof t.default;"object"!==h&&"function"!==h||(s=t,a=t.default);var l="function"==typeof a?a.options:a;e&&(l.render=e.render,l.staticRenderFns=e.staticRenderFns,l._compiled=!0),i&&(l.functional=!0),o&&(l._scopeId=o);var c;if(r?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=c):n&&(c=n),c){var u=l.functional,f=u?l.render:l.beforeCreate;u?(l._injectStyles=c,l.render=function(t,e){return c.call(e),f(t,e)}):l.beforeCreate=f?[].concat(f,c):[c]}return{esModule:s,exports:a,options:l}}},function(t,e,i){"use strict";var n=i(10);e.a={data:function(){return{width:0,height:0,ratio:0,ctx:null,options:null,colWidth:[],rowHeight:[],x:[],y:[],cellMap:[],source:null,TDArr:null}},props:{config:Object},methods:{init:function(){var t=this,e=this.ctx=this.$refs.canvas.getContext("2d"),i=window.devicePixelRatio||1,o=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,r={};for(var s in n.a)r[s]=n.a[s],this.config&&this.config[s]&&(r[s]=this.config[s]);this.options=r;var a=this.ratio=i/o;this.width=(r.width||window.innerWidth)*a,this.height=(r.height||window.innerHeight)*a,this.options.fontSize*=a,this.options.paddingLR*=a,this.options.paddingTB*=a,this.$nextTick(function(){t.initCanvas()})},initCanvas:function(){var t=this;this.resetCanvas(),this.initTableData(),this.$nextTick(function(){t.resetCanvas(),t.initScroll(),t.painted()})},resetCanvas:function(){var t=this.ctx,e=this.options;this.height,this.width;t.lineWidth=1,t.font="normal "+e.fontSize+"px "+e.fontFamily,t.textBaseline="middle",t.strokeStyle=e.lineColor,t.textAlign="center",t.save()},initTableData:function(){var t=this;this.TDArr=this.options.to2DArr(this.options.source),this.source=this.options.source;var e=this.options,i=this.ctx,n=this.width,o=this.height,r=[],s=[],a=0,h=0;if(this.cellMap=[],this.TDArr.forEach(function(o,a){var l=e.fontSize+e.paddingTB;t.cellMap[a]||(t.cellMap[a]=[]),o.forEach(function(o,s){t.cellMap[a][s]||(t.cellMap[a][s]={}),t.cellMap[a][s]=e.setCellOpts.call(t,a,s,e.index2Data.call(t,a,s)),r[s]||(r[s]=[]);var h=i.measureText(o).width,c=(e.cellMaxWidth||Math.ceil(n/3))-e.paddingLR;h>c&&(t.cellMap[a][s].lineNum=Math.ceil(h/c),t.cellMap[a][s].length=Math.ceil(h/t.cellMap[a][s].lineNum/Math.floor(h/o.length)),h=c,l=e.fontSize*t.cellMap[a][s].lineNum+e.paddingTB+(t.cellMap[a][s].lineNum-1)*e.lineHeight);var u=Math.floor(h+e.paddingLR);r[s].push(u)}),h+=l,s[a]=l}),this.colWidth=r.map(function(t){var e=Math.max.apply(null,t);return a+=e,e}),this.rowHeight=s,a<n){var l=n/this.colWidth.length;this.colWidth=this.colWidth.map(function(t){return l})}h<o&&(this.height=h),this.x=[],this.y=[],this.colWidth.reduce(function(e,i,n){return t.x.push(e),n===t.colWidth.length-1&&t.x.push(e+i),e+i},0),this.rowHeight.reduce(function(e,i,n){return t.y.push(e),n===t.rowHeight.length-1&&t.y.push(e+i),e+i},0)}},computed:{styles:function(){return{width:this.width/this.ratio+"px",height:this.height/this.ratio+"px"}}}}},function(t,e,i){"use strict";e.a={source:{columns:["暂无数据"],datas:[]},width:0,height:0,cellMaxWidth:0,paddingLR:22,paddingTB:22,lineHeight:8,fontSize:16,fontColor:"#333333",fontFamily:"Microsoft YaHei",sliderColor:"rgba(0, 0, 0,.3)",lineColor:"#ededed",lockRows:0,lockColumns:0,to2DArr:function(t){var e=[];return e.push(t.columns),t.datas.forEach(function(t){e.push(t.columns)}),e},index2Data:function(t,e){return 0===t?{row:t,col:e,rowData:this.source.columns,colData:this.source.columns[e]}:{row:t,col:e,rowData:this.source.datas[t-1],colData:this.source.datas[t-1].columns[e]}},setCellOpts:function(t,e,i){return 0===t?{color:"#F8F8F8"}:i.rowData.clickAble?{arrow:!0,color:"#FFFFFF"}:{color:"#F8F8F8"}}}},function(t,e,i){"use strict";e.a={data:function(){return{offset:[0,0],V:{size:0,y:0,prevY:0,startY:0,move:!1,show:!1},H:{size:0,x:0,prevX:0,startX:0,move:!1,show:!1},prevTime:0,timer:null}},methods:{initScroll:function(){var t=this.x,e=this.y,i=this.height,n=this.width,o=i/e[e.length-1],r=n/t[t.length-1];this.V.size=o>=1?0:i*o,this.H.size=r>=1?0:n*r,this.V.y=0,this.H.x=0,this.V.ratio=o,this.H.ratio=r,this.offset=[0,0]},onWheel:function(t){var e=this;this.V.show=!0,this.scrollY(t.deltaY,t),this.timer?this.prevTime=Date.now():this.timer=setInterval(function(){0!=e.prevTime&&Date.now()-e.prevTime>1e3&&(e.V.show=!1,clearInterval(e.timer),e.timer=null)},1e3)},onStart:function(t,e){var i=t.touches?t.touches[0]:t,n=i.screenX,o=i.screenY;if("touch"===e)return this.H.prevX=n,this.H.startX=n,this.V.prevY=o,void(this.V.startY=o);"V"===e?(this.V.prevY=o,this.V.move=!0,this.V.show=!0):(this.H.prevX=n,this.H.move=!0,this.H.show=!0)},onEnd:function(){var t=this;this.V.move=!1,this.H.move=!1,setTimeout(function(){t.V.show=!1,t.H.show=!1},1e3)},onDrag:function(t,e){var i=this.V,n=this.H,o=t.touches?t.touches[0]:t,r=o.screenX,s=o.screenY;if("touch"===e)return void(Math.abs(s-i.startY)>Math.abs(r-n.startX)?(this.scrollY(-(s-i.prevY)/this.V.ratio,t),this.V.prevY=s,this.V.show=!0):(this.scrollX(-(r-n.prevX)/this.H.ratio,t),this.H.prevX=r,this.H.show=!0));i.move?(this.scrollY((s-i.prevY)/this.V.ratio),this.V.prevY=s):n.move&&(this.scrollX((r-n.prevX)/this.H.ratio),this.H.prevX=r)},scrollY:function(t,e){if(this.V.size){t*=this.V.ratio;var i=this.height-this.V.size,n=this.V.y+t;n>0&&n<i?(e&&e.preventDefault(),this.V.y+=t):this.V.y=n<=0?0:i,this.offset[1]=-this.V.y/this.V.ratio,requestAnimationFrame(this.painted)}},setBarVisible:function(t,e,i){e?this.V.show=i:this.H.show=i},scrollX:function(t,e){if(this.H.size){t*=this.H.ratio;var i=this.width-this.H.size,n=this.H.x+t;n>0&&n<i?(e&&e.preventDefault(),this.H.x+=t):this.H.x=n<=0?0:i,this.offset[0]=-this.H.x/this.H.ratio,requestAnimationFrame(this.painted)}}}}},function(t,e,i){"use strict";var n=function(){function t(t,e){var i=[],n=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=new Image;o.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAASCAYAAABit09LAAAA5UlEQVQokX3QvytFYRgH8M856g538Q9YjWaDjRulKEw3ZVeMyo8V84nBZmWilPs/GJS6BoNEGGSQxaYM76Ou03m99Uzvp6fv8y2qqupiC8voy7wSYzE9jPwHt3EUqIfhHIR1XMTmM7Ry8BtdXGESxyiaIHxhDvdx2H4Owjtm8IJNrOYgPGAWnzjEfA6S+lyM7CcYz0G4xhPa2MvBNi4xGtuXmmAL55gYzFuHQzjFNJ4xJTXw55hCKnoBr1Lxj7+fg/AAK3hDRypeHe5iTSq8g7t68BIb2MFHZLttOFAZofuBbpoQ/ADaQTDapr59bQAAAABJRU5ErkJggg==",o.width/=2,o.height/=2,e.a={methods:{painted:function(){this.clear(),this.paintMain()},clear:function(){this.ctx.clearRect(0,0,this.width,this.height)},paintMain:function(){var t=this.TDArr,e=this.x,i=this.y,r=this.colWidth,s=this.rowHeight,a=this.ctx,h=this.width,l=this.height,c=this.options,u=this.cellMap,f=this.ratio,d=n(this.offset,2),p=d[0],v=d[1];a.beginPath(),a.beginPath(),a.moveTo(0,0),a.lineTo(0,l),a.lineTo(h,l),a.lineTo(h,0),a.lineTo(0,0),a.stroke();for(var g=t.length;g--;){var m=g<=c.lockRows-1,y=g<=c.lockRows,x=t[g].length,w=i[c.lockRows]||0;if(0!==g){var b=i[g]+.5+(y?0:v);(b>=w||y)&&b<=l&&(a.moveTo(.5,b),a.lineTo(h+.5,b))}for(;x--;){var H=x<=c.lockColumns-1,C=x<=c.lockColumns,A=e[c.lockColumns]||0;if(0===g){var V=e[x]+.5+(C?0:p);(V>=A||C)&&V<=h&&(a.moveTo(V,.5),a.lineTo(V,l+.5))}var S=e[x]+(H?0:p),T=e[x+1]+(H?0:p),M=i[g]+(m?0:v),R=i[g+1]+(m?0:v);if(S>=-(T-S)&&S<=h&&M>=-(R-M)&&M<=l||T>=A&&T<=h&&R>=w&&R<=l){a.fillStyle=u[g][x].color;var k=T-S,D=R-M;if(a.fillRect(S,M,k,D),a.fillStyle=c.fontColor,x===u[g].length-1&&u[g][x].arrow){var B=o.width*f,E=o.height*f;a.drawImage(o,T-B/2-c.paddingLR/2,R-D/2-E/2,B,E)}var Y=u[g][x].lineNum,_=e[x]+r[x]/2;if(Y){var j=u[g][x].length,z=0,F=0,X=Y%2,N=X?(Y-1)/2:Y/2,O=i[g]+s[g]/2;for(O-=c.fontSize*N,O-=X?c.lineHeight*N:-c.lineHeight+c.lineHeight*(N-1);F<=Y;)0!==F&&(O+=c.lineHeight+c.fontSize),a.fillText(t[g][x].substring(z,z+j),_+(H?0:p),O+(m?0:v),r[x]),z+=j,F++}else{var W=i[g]+s[g]/2;a.fillText(t[g][x],_+(H?0:p),W+(m?0:v),r[x])}}}}a.stroke()}}}},function(t,e,i){"use strict";var n=function(){function t(t,e){var i=[],n=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw r}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();e.a={methods:{onClick:function(t){this.$emit("click",this.options.index2Data.apply(this,this.xy2Index(t.offsetX,t.offsetY)))},xy2Index:function(t,e){for(var i=this.x,o=this.y,r=this.options,s=r.lockRows,a=r.lockColumns,h=n(this.offset,2),l=h[0],c=h[1],u=this.ratio,f=0,d=0,p=!1,v=!1;s--&&e<o[s+1]/u;)p=!0,f=s;for(;a--&&t<i[a+1]/u;)v=!0,f=a;if(!p)for(var g=0;g<o.length&&e>(o[g]+c)/u;g++)f=g;if(!v)for(var m=0;m<i.length&&t>(i[m]+l)/u;m++)d=m;return[f,d]}}}},function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container",style:t.styles,on:{mousemove:t.onDrag,mouseup:t.onEnd}},[i("canvas",{ref:"canvas",style:t.styles,attrs:{width:t.width,height:t.height},on:{wheel:t.onWheel,touchstart:function(e){t.onStart(e,"touch")},touchmove:function(e){t.onDrag(e,"touch")},touchend:t.onEnd,click:function(e){t.onClick(e)}}}),t._v(" "),i("div",{staticClass:"V",style:{height:t.height/t.ratio,opacity:t.V.show?1:0},on:{mouseenter:function(e){t.setBarVisible(e,1,1)}}},[i("div",{staticClass:"slider",style:{background:t.options?t.options.sliderColor:"#000",height:t.V.size/t.ratio+"px",top:t.V.y/t.ratio+"px"},on:{mousedown:function(e){t.onStart(e,"V")}}})]),t._v(" "),i("div",{staticClass:"H",style:{width:t.width/t.ratio,opacity:t.H.show?1:0},on:{mouseenter:function(e){t.setBarVisible(e,0,1)}}},[i("div",{staticClass:"slider",style:{background:t.options?t.options.sliderColor:"#000",width:t.H.size/t.ratio+"px",left:t.H.x/t.ratio+"px"},on:{mousedown:function(e){t.onStart(e,"H")}}})])])},o=[],r={render:n,staticRenderFns:o};e.a=r}])});
//# sourceMappingURL=vue-canvas-table.js.map